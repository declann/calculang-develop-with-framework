/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/automation-events@7.0.3/build/es2019/module.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
const t=(t,e,i)=>({endTime:e,insertTime:i,type:"exponentialRampToValue",value:t}),e=(t,e,i)=>({endTime:e,insertTime:i,type:"linearRampToValue",value:t}),i=(t,e)=>({startTime:e,type:"setValue",value:t}),a=(t,e,i)=>({duration:i,startTime:e,type:"setValueCurve",values:t}),n=(t,e,{startTime:i,target:a,timeConstant:n})=>a+(e-a)*Math.exp((i-t)/n),s=t=>"exponentialRampToValue"===t.type,o=t=>"linearRampToValue"===t.type,u=t=>s(t)||o(t),l=t=>"setValue"===t.type,r=t=>"setValueCurve"===t.type,m=(t,e,i,a)=>{const s=t[e];return void 0===s?a:u(s)||l(s)?s.value:r(s)?s.values[s.values.length-1]:n(i,m(t,e-1,s.startTime,a),s)},v=(t,e,i,a,n)=>void 0===i?[a.insertTime,n]:u(i)?[i.endTime,i.value]:l(i)?[i.startTime,i.value]:r(i)?[i.startTime+i.duration,i.values[i.values.length-1]]:[i.startTime,m(t,e-1,i.startTime,n)],h=t=>"cancelAndHold"===t.type,d=t=>"cancelScheduledValues"===t.type,T=t=>h(t)||d(t)?t.cancelTime:s(t)||o(t)?t.endTime:t.startTime,c=(t,e,i,{endTime:a,value:n})=>i===n?n:0<i&&0<n||i<0&&n<0?i*(n/i)**((t-e)/(a-e)):0,_=(t,e,i,{endTime:a,value:n})=>i+(t-e)/(a-e)*(n-i),f=(t,{duration:e,startTime:i,values:a})=>((t,e)=>{const i=Math.floor(e),a=Math.ceil(e);return i===a?t[i]:(1-(e-i))*t[i]+(1-(a-e))*t[a]})(a,(t-i)/e*(a.length-1)),p=t=>"setTarget"===t.type;class E{constructor(t){this._automationEvents=[],this._currenTime=0,this._defaultValue=t}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(n){const l=T(n);if(h(n)||d(n)){const o=this._automationEvents.findIndex((t=>d(n)&&r(t)?t.startTime+t.duration>=l:T(t)>=l)),m=this._automationEvents[o];if(-1!==o&&(this._automationEvents=this._automationEvents.slice(0,o)),h(n)){const n=this._automationEvents[this._automationEvents.length-1];if(void 0!==m&&u(m)){if(void 0!==n&&p(n))throw new Error("The internal list is malformed.");const i=void 0===n?m.insertTime:r(n)?n.startTime+n.duration:T(n),a=void 0===n?this._defaultValue:r(n)?n.values[n.values.length-1]:n.value,o=s(m)?c(l,i,a,m):_(l,i,a,m),u=s(m)?t(o,l,this._currenTime):e(o,l,this._currenTime);this._automationEvents.push(u)}if(void 0!==n&&p(n)&&this._automationEvents.push(i(this.getValue(l),l)),void 0!==n&&r(n)&&n.startTime+n.duration>l){const t=l-n.startTime,e=(n.values.length-1)/n.duration,i=Math.max(2,1+Math.ceil(t*e)),s=t/(i-1)*e,o=n.values.slice(0,i);if(s<1)for(let t=1;t<i;t+=1){const e=s*t%1;o[t]=n.values[t-1]*(1-e)+n.values[t]*e}this._automationEvents[this._automationEvents.length-1]=a(o,n.startTime,t)}}}else{const i=this._automationEvents.findIndex((t=>T(t)>l)),a=-1===i?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[i-1];if(void 0!==a&&r(a)&&T(a)+a.duration>l)return!1;const u=s(n)?t(n.value,n.endTime,this._currenTime):o(n)?e(n.value,l,this._currenTime):n;if(-1===i)this._automationEvents.push(u);else{if(r(n)&&l+n.duration>T(this._automationEvents[i]))return!1;this._automationEvents.splice(i,0,u)}}return!0}flush(t){const e=this._automationEvents.findIndex((e=>T(e)>t));if(e>1){const t=this._automationEvents.slice(e-1),a=t[0];p(a)&&t.unshift(i(m(this._automationEvents,e-2,a.startTime,this._defaultValue),a.startTime)),this._automationEvents=t}}getValue(t){if(0===this._automationEvents.length)return this._defaultValue;const e=this._automationEvents.findIndex((e=>T(e)>t)),i=this._automationEvents[e],a=(-1===e?this._automationEvents.length:e)-1,h=this._automationEvents[a];if(void 0!==h&&p(h)&&(void 0===i||!u(i)||i.insertTime>t))return n(t,m(this._automationEvents,a-1,h.startTime,this._defaultValue),h);if(void 0!==h&&l(h)&&(void 0===i||!u(i)))return h.value;if(void 0!==h&&r(h)&&(void 0===i||!u(i)||h.startTime+h.duration>t))return t<h.startTime+h.duration?f(t,h):h.values[h.values.length-1];if(void 0!==h&&u(h)&&(void 0===i||!u(i)))return h.value;if(void 0!==i&&s(i)){const[e,n]=v(this._automationEvents,a,h,i,this._defaultValue);return c(t,e,n,i)}if(void 0!==i&&o(i)){const[e,n]=v(this._automationEvents,a,h,i,this._defaultValue);return _(t,e,n,i)}return this._defaultValue}}const V=t=>({cancelTime:t,type:"cancelAndHold"}),y=t=>({cancelTime:t,type:"cancelScheduledValues"}),g=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),x=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),R=(t,e,i)=>({startTime:e,target:t,timeConstant:i,type:"setTarget"});export{E as AutomationEventList,V as createCancelAndHoldAutomationEvent,y as createCancelScheduledValuesAutomationEvent,g as createExponentialRampToValueAutomationEvent,x as createLinearRampToValueAutomationEvent,R as createSetTargetAutomationEvent,i as createSetValueAutomationEvent,a as createSetValueCurveAutomationEvent};export default null;
